# 关于协议解析框架的构思
## 输入
1. 离线的pcap文件
2. 实时接入网络数据流
3. 非标准pcap文件，即每条报文头部添加了其它信息，需允许用户配置规则进行解析

## 输出
1. 支持协议全字段解析结果保存为文本文件
2. 支持协议全字段解析结果输出到ES数据库或其他数据库
3. 解析的每个协议需有详细的字段说明文件
4. 支持json格式的输出方式

## 开发语言
开发语言：C语言
抓包工具：
- Linux平台中采用libpcap或性能优于libpcap的其它工具
- Windows平台采用winpcap或性能优于winpcap的其它工具

## 运行平台
1. Linux平台
2. Windows平台

## 其它要求
1. 单机部署时解析速度能达到1000Mbit/s
2. 支持分布式部署以提升解析速度
3. 框架可支持用户快速增量开发，以实现扩充支持更多协议的目的
4. 支持离线安装
5. 具备会话还原、会话重组的功能，支持基于邮件协议（至少包含SMTP、POP3、IMAP）还原原始邮件完整内容，支持基于HTTP协议还原HTML页面
6. 协议识别的规则支持配置文件或其它方式动态加载
7. 解析时允许用户添加额外的字段
8. 对于错误pcap文件解析时具有一定的容错能力
9. 代码需有相对详细的注释说明
10. 每个协议的解析程序需注明依据的RFC文档编号及相关网址
11. 支持各大主流语种，避免乱码及无法解码的情况
12. 框架有完善的文档说明（开发手册）
13. 包含至少15种主流协议的解析程序，例如：HTTP、SMTP、POP3、IMAP、BGP、OSPF、EIGRP、RIP、SNMP、ICMP、TCP、UDP、IPv4、IPv6、DNS
14. 每一个协议的解析程序中，字段的命名尽量与RFC参考文档中的字段说明保持一致，便于阅读
15. 集成wireshark的协议类型识别的规则库（字典）
16. 离线pcap文件的解析支持增量解析（目录监视）

## 可参考选型
arkime （https://arkime.com/ ）

## 开发周期
2021年6月5日前完成所有交付环节

## 交付及售后
1. 源码
2. 安装环境
3. 部署手册、开发手册及其它相关文档
4. 提供演示及测试环境
5. 培训我方开发人员至少会新增一种协议